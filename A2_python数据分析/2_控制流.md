
我们涵盖了：
*   **循环 (`for`, `while`)**：如何重复执行任务。
*   **条件语句 (`if/elif/else`)**：如何根据条件做出决策。
*   **Pandas中的应用**：如何使用 `iterrows()` 进行直观的遍历，以及更重要的——如何使用 `.apply()` 方法高效地将你的逻辑（函数）应用到整列数据上，这正是**数据分箱**和**特征标记**的精髓。


### 控制流在数据分析中的应用总结

| 概念 (Concept) | 核心作用 (Core Function) | 关键语法/模式 (Key Syntax/Pattern) | 数据分析中的典型应用场景 | 注意事项/最佳实践 |
| :--- | :--- | :--- | :--- | :--- |
| **`for` 循环** | 遍历一个已知的序列（如列表），对每个元素执行操作。 | `for item in iterable:`<br>`    # ... 对 item 做某事` | - 遍历一个简单的列表进行计算（如求和）。<br>- **学习时**用来理解如何逐行处理数据。 | 对于大型DataFrame，**性能较低**。请优先考虑下面介绍的Pandas原生方法。 |
| **`while` 循环** | 当某个条件为真时，持续重复执行代码块。用于**未知循环次数**的场景。 | `while condition:`<br>`    # ... 做某事`<br>`    # ... 更新条件` | - **从API分页获取数据**，直到API返回空列表为止。 | **必须**在循环内部有能让`condition`最终变为`False`的逻辑，否则会造成**死循环**。 |
| **`if/elif/else`** | 根据不同的条件执行不同的代码分支，实现复杂的逻辑判断。 | `if condition1:`<br>`    # ...`<br>`elif condition2:`<br>`    # ...`<br>`else:`<br>`    # ...` | - **数据清洗**：识别并处理异常值。<br>- **特征工程**：实现数据分箱（数值归类）或基于关键词打标签。 | 这是所有逻辑的核心。它通常被封装在**函数**中，以便被`.apply()`等方法调用。 |
| **`df.iterrows()`** | 一种**遍历DataFrame行**的方法，每次返回 `(索引, 行数据Series)`。 | `for index, row in df.iterrows():`<br>`    value = row['column_name']` | - 需要同时访问行索引和行内多个值的简单遍历。<br>- **直观易懂**，适合教学和快速原型验证。 | **效率很低！**因为每次循环都要创建一个新的Series对象。在处理大数据时，应**极力避免**使用。 |
| **`.apply()` 方法** | **(核心重点)** 将一个自定义函数（即你的“规则”）应用到DataFrame的一整列（一个Series）的**每个元素**上。 | `def my_func(x):`<br>`    # ... 对 x 的逻辑判断`<br>`    return result`<br><br>`df['新列'] = df['旧列'].apply(my_func)` | - **数据分箱/分类**：如根据“消费金额”评定“客户等级”。<br>- **文本处理**：如根据“邮件标题”判断“是否紧急”。<br>- 任何需要对一列数据应用复杂`if/else`逻辑的场景。 | **这是Pandas中执行复杂条件逻辑的首选方法**。它实现了“规则”与“执行”的分离，代码清晰，性能远超手动循环。 |


---
tags:
  - 计量经济学
  - econometrics
  - 异方差
aliases:
  - Heteroskedasticity
source: https://www.bilibili.com/video/BV1QJ411h7YX/
---

# 【计量经济学】异方差

> [!note] 视频来源
> **UP主**: [河财代无天](https://space.bilibili.com/39274883)
> **标题**: 【计量经济学】代有地期末过关攻略
> **链接**: [https://www.bilibili.com/video/BV1QJ411h7YX/](https://www.bilibili.com/video/BV1QJ411h7YX/)
> **发布时间**: 2019-12-31

---

### 全部问题汇总

| 主要问题 | 核心内容 | 关键词 |
| :--- | :--- | :--- |
| **概念** | 从同方差到异方差的定义 | `同方差`, `异方差`, `随机误差项`, `Var(uᵢ)`, `σ²`, `σᵢ²` |
| **后果** | OLS估计量不再BLUE, 显著性检验失效, 预测区间精度下降 | `最小方差性`, `t检验`, `F检验`, `预测区间` |
| **检验方法** | 图示法 | `残差平方图`, `递增型`, `递减型`, `复杂型` |
| | 戈德菲尔德-匡特(GQ)检验 | `分样本`, `剔除中间c个样本`, `RSS`, `F统计量` |
| | 怀特(White)检验 | `辅助回归`, `n*R²`, `卡方分布`, `p-1` |
| | 戈莱瑟(Glejser)检验 | `残差绝对值`, `四种回归形式`, `t检验`, `R²` |
| **补救措施** | 加权最小二乘法(WLS) | `加权变换`, `权序列`, `hᵢ⁻¹` |
| | 怀特异方差稳健标准误 | `稳健性方差/标准差/t统计量`, 只记概念 |

---

## 1. 异方差的概念

我们从逻辑，从它的概念到后果，再到它的检验方法，最后再到它的补救措施。

*   **同方差 (Homoskedasticity)**
    要想知道什么叫异方差，我们先要知道什么是同方差。同方差，它是指我们模型的后面那个小尾巴——**随机误差项的方差**。
    $$
    Var(u_i) = \sigma^2
    $$
    本来我们不同随机误差项的方差是相同的，都等于一个实数 $\sigma^2$。

*   **异方差 (Heteroskedasticity)**
    但是后来由于我们模型设定出现的一些问题，导致了我们模型不同的随机误差项之间的方差不一样。从原来的一个实数 $\sigma^2$ 变成了 $\sigma_i^2$。它表示随着我这个 $i$ 的不同，我这个 $u_i$（$u_1, u_2, u_3, u_4...$）对应的方差也不同（$\sigma_1^2, \sigma_2^2, \sigma_3^2...$）。好吧，这个 $i$ 表示一种变化，也就是不同的随机误差项对应不同的方差，这就叫做异方差。

## 2. 异方差的后果
异方差的后果和之前的多重共线性基本一致，大家可以放到一块去记。

1.  **参数估计量不再具有最小方差性**
    具有异方差问题的模型，它的参数用普通最小二乘法(OLS)估计得出来的估计值**不再具有最小方差性**。因为同方差是模型具有最小方差性（BLUE，最佳线性无偏估计量）的前提之一。当基本假定被违背时，优良性质就不再成立了。

2.  **显著性检验失效**
    因为参数的方差出现了问题，所以参数的标准差也肯定出现了问题。而 $t$ 检验的 $t$ 值是等于参数比上参数的标准差。
    $$
    t = \frac{\hat{\beta}}{se(\hat{\beta})}
    $$
    标准差出现了问题，那么和它相关的 $t$ 检验的 $t$ 值当然也就出现问题了，所以我们说 $t$ 检验失效。
    当然了，和随机误差项的方差相关的不仅是 $t$ 检验，**$F$ 检验也和随机误差项的方差是相关的**，所以我们的 $F$ 检验也是失效的。$t$ 检验加 $F$ 检验，它们统称为显著性检验，所以显著性检验是失效的。

3.  **预测区间精度下降**
    预测区间的表达式中包含参数的标准差。当参数的标准差出现了问题，我们的预测区间的后果就是它的下限往左移，上限往右移，会使它的**置信区间变大**。变大就意味着它的精度下降，就意味着它不可靠了。

## 3. 异方差的检验

### 3.1 图示法 (Graphical Method)

因为异方差就是随机误差项的方差在不同的观测点不一样，那么我们是不是就可以做不同观测点下方差的图呢？但随机误差项 $u_i$ 我们求不出来，所以它的方差也求不出来。我们只能退而求其次，用它的估计量——**残差**来代替。
我们在画图的时候，用**残差的平方 ($e_i^2$)** 代替随机误差项的方差 ($Var(u_i)$) 去作图。

通过EViews可以做出它们的图，总共有四种情况：
*   **同方差**：随着解释变量 $X$ 的增加，残差平方基本上在一个小区间内稳定地波动。
*   **递增型异方差**：随着解释变量 $X$ 的变化，残差的平方不断地增大。
*   **递减型异方差**：与递增型相反，残差的平方不断地减小。
*   **复杂型异方差**：可能一会儿减小，一会儿增大，或者是波浪形等其他乱七八糟的形状。

这个方法不仅可以检验异方差，也可以帮助你理解异方差的分类。

### 3.2 戈德菲尔德-匡特检验 (Goldfeld-Quandt Test)

**核心思想**：
如果是同方差模型，我把这个数据分成两个子样本，这两个子样本的方差是不是应该相同或者至少比较接近？
同样，由于随机误差项的方差不好求，我们用一个和它相关的统计量——**残差平方和 (RSS)** 来代替。

**检验步骤**：
1.  **排序**：将样本数据按照解释变量 $X$ 的值从小到大（检验递增型）或从大到小（检验递减型）排序。这个方法只能检验递增型和递减型异方差。
2.  **剔除样本**：从排好序的样本中间挖取 $c$ 个数据，通常 $c \approx n/4$。
3.  **分组**：把剩下的数据分成两个数量相等的子样本。
4.  **回归**：分别对这两个子样本做OLS回归，得到它们各自的残差平方和 $RSS_1$（前面那个子样本）和 $RSS_2$（后面那个子样本）。
5.  **构造F统计量**：
    $$
    F = \frac{RSS_2}{RSS_1}
    $$
6.  **比较**：将计算出的 $F$ 统计量与临界值 $F_{\alpha}$ 进行比较。
    *   临界值的自由度为：
        $$
        F_{crit} = F_{\alpha}\left(\frac{n-c}{2}-k-1, \frac{n-c}{2}-k-1\right)
        $$
        其中，$n$ 是总样本容量，$c$ 是剔除的样本数，$k$ 是解释变量的个数。
    *   **判定规则**：
        *   若 $F > F_{crit}$：拒绝原假设，表示存在显著的异方差。
        *   若 $F \le F_{crit}$：不拒绝原假设，表示模型存在同方差。

> [!example] 实例：第二套试卷选择题第七题
> **题干**：根据样本容量为 $56$ 的样本数据建立含截距项的一元线性回归模型。利用戈德菲尔德-匡特检验法检测该模型是否存在递增型异方差。对样本数据进行适当排序并剔除中间的 $14$ 个观测值后，得到两个子样本的残差平方和分别为 $RSS_1=21, RSS_2=131$。该检验服从的分布和统计量的值分别为？
> 
> **分析**：
> 1.  **已知信息**：$n=56$，$k=1$ (一元模型)，$c=14$。
> 2.  **计算F统计量的值**：
>     $$
>     F = \frac{RSS_2}{RSS_1} = \frac{131}{21}
>     $$
>     （选项中给的是 $131/21$ 和 $21/131$，后者是迷惑项）
> 3.  **确定分布（自由度）**：
>     $$
>     df = \frac{n-c}{2}-k-1 = \frac{56-14}{2}-1-1 = \frac{42}{2}-2 = 21-2 = 19
>     $$
>     所以，F统计量服从自由度为 $(19, 19)$ 的F分布，即 $F(19, 19)$。
> 4.  **结论**：选择分布为 $F(19, 19)$，统计量值为 $131/21$ 的选项。

### 3.3 怀特检验 (White Test)

怀特检验几乎是必考的。

**检验步骤**：
1.  **构造辅助回归模型**：
    对原模型进行OLS回归，得到残差 $e_i$。然后，构造一个辅助回归模型，以**残差的平方 $e_i^2$** 为被解释变量，以**原模型所有解释变量、它们的平方项和交叉项**为解释变量。
    例如，原模型为 $Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + u_i$，则辅助回归模型为：
    $$
    e_i^2 = \alpha_0 + \alpha_1 X_{1i} + \alpha_2 X_{2i} + \alpha_3 X_{1i}^2 + \alpha_4 X_{2i}^2 + \alpha_5 X_{1i}X_{2i} + v_i
    $$
2.  **获取 $R^2$**：对辅助回归模型进行OLS估计，得到其可决系数 $R^2$。
3.  **构造LM统计量**：
    $$
    LM = n \cdot R^2
    $$
    其中 $n$ 为样本容量。
4.  **比较**：在原假设（存在同方差）下，LM统计量服从卡方分布。
    *   临界值的自由度为：$p-1$，其中 $p$ 是**辅助回归模型中解释变量的个数（包括截距项）**。
        $$
        \chi^2_{crit} = \chi^2_{\alpha}(p-1)
        $$
    *   **判定规则**：
        *   若 $LM > \chi^2_{crit}$：拒绝原假设，模型存在异方差。
        *   若 $LM \le \chi^2_{crit}$：不拒绝原假设，模型存在同方差。

> [!example] 实例分析
> **题干**：给出一个EViews辅助回归的输出表，其中因变量是残差平方，自变量是 C, X, X^2。`Included observations: 31`，`R-squared: ...`。显著性水平为 $0.05$。
> 1.  **计算LM统计量**：
>     *   从表中找到 $n$ (Included observations) = $31$。
>     *   找到 $R^2$ (R-squared)。
>     *   LM统计量 $a = n \cdot R^2 = 31 \times R^2$。
> 2.  **判断是否存在异方差**：
>     *   **确定临界值**：
>         *   显著性水平 $\alpha = 0.05$。
>         *   辅助回归的参数有 $3$ 个（C, X, X^2），所以 $p=3$。
>         *   自由度为 $p-1 = 3-1 = 2$。
>         *   查表得到临界值 $\chi^2_{0.05}(2)$。
>     *   **比较**：将计算出的 $n \cdot R^2$ 与临界值 $\chi^2_{0.05}(2)$ 比较，做出判断。

### 3.4 戈莱瑟(Glejser)检验
(UP主口误为“克里斯检验”，但其描述的是Glejser检验)

这个检验你不需要理解太多，只需要知道大概定义，只会考小题。
**核心思想**：
用**残差的绝对值 $|e_i|$** 对每一个解释变量 $X_j$ 做四种形式的普通最小二乘回归。这四种形式为：
1.  $|e_i|$ 对 $X_j$ 回归
2.  $|e_i|$ 对 $X_j$ 的倒数 ($1/X_j$) 回归
3.  $|e_i|$ 对 $X_j$ 的根式 ($\sqrt{X_j}$) 回归
4.  $|e_i|$ 对 $X_j$ 的根式的倒数 ($1/\sqrt{X_j}$) 回归

**判定规则**：
*   对每一个回归，都看它的 **$t$ 检验**是否显著。
*   如果某个回归模型显著，则说明解释变量存在该形式的异方差。
*   如果**不止一个**模型显著，则比较它们的 **$R^2$**，**$R^2$ 大的**那个就能确定异方差的具体形式。

## 4. 异方差的补救

### 4.1 加权最小二乘法 (WLS)

这个方法只会考步骤，不会让你具体去求参数。
**核心思想**：通过对模型进行加权变换，消除异方差，然后再使用OLS。

**步骤**：
1.  **确定异方差形式**：假设已知随机误差项的方差形式为
    $$
    Var(u_i) = \sigma^2 h_i^2
    $$
2.  **确定权序列**：权序列 (Weighting Series) 是 $h_i$ 的倒数，即 $1/h_i$。
3.  **进行加权变换**：将原模型的左右两边同时乘以权序列 $1/h_i$。这个过程叫做**加权变换 (Weighting Transformation)**。
    $$
    \frac{Y_i}{h_i} = \beta_0 \frac{1}{h_i} + \beta_1 \frac{X_i}{h_i} + \frac{u_i}{h_i}
    $$
    得到的这个新模型叫做**加权模型 (Weighted Model)**。
4.  **OLS估计**：对加权模型进行普通最小二乘估计。经过变换后，新的误差项 $u_i/h_i$ 是同方差的，因此可以使用OLS。
5.  **得到估计量**：得到的参数估计量就是**加权最小二乘估计量 (WLS Estimator)**，记为 $\hat{\beta}^{WLS}$。

> [!example] 考题示例
> **题干**：如果随机误差项的方差为 $Var(u_i) = \sigma^2 X_i^2$，你打算用什么方法去估计模型？请写出具体的估计步骤。
>
> **解答步骤**：
> 1.  该模型存在异方差，其形式为 $Var(u_i) = \sigma^2 X_i^2$。因此，应采用加权最小二乘法(WLS)。
> 2.  在此模型中，$h_i^2 = X_i^2$，所以 $h_i = X_i$。
> 3.  确定**权序列**为 $1/h_i = 1/X_i$。
> 4.  进行**加权变换**：将原模型 $Y_i = \beta_0 + \beta_1 X_i + u_i$ 左右两边同除以 $X_i$，得到**加权模型**：
>     $$
>     \frac{Y_i}{X_i} = \beta_0 \left(\frac{1}{X_i}\right) + \beta_1 + \frac{u_i}{X_i}
>     $$
> 5.  对该加权模型使用普通最小二乘法(OLS)进行回归，即可得到参数的**加权最小二乘估计量** $\hat{\beta}_0^{WLS}$ 和 $\hat{\beta}_1^{WLS}$。

### 4.2 怀特异方差稳健标准误

这个方法大家只需要记住一些概念就可以了，过程不需要了解。
通过怀特异方差稳健性程序，你可以得到：
*   **异方差稳健性方差** (Heteroskedasticity-Consistent Variance)
*   **异方差稳健性标准差** (Heteroskedasticity-Consistent Standard Error)
*   **异方差稳健性 $t$ 统计量** (Heteroskedasticity-Consistent t-statistic)

你只需要记住，这些加了“稳健性”前缀的量，都是对异方差的一种**补救措施**，它们在存在异方差的情况下依然是有效的，可以用来进行正确的假设检验。

---
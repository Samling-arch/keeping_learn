
# 1 MySQL 数据库查询 (SELECT & WHERE)

## 1.1 核心知识点总结

> [!NOTE] 通俗概括
> 这张表格就像是这节课的“武功秘籍目录”，让你一眼就知道我们学了哪些招式，每招是干嘛的。

| 命令/关键字 (Command/Keyword) | 作用 (Function) | 通俗解释 (Simple Explanation) | 示例语法 (Example Syntax) |
| --- | --- | --- | --- |
| `SELECT ... FROM ...` | 查询数据 | 从指定的“表格抽屉”里拿出“文件”。 | `SELECT name, age FROM emp;` |
| `*` (通配符) | 查询所有字段 | 把这个“文件”上写的每一项信息（姓名、年龄、薪水等）都拿出来。 | `SELECT * FROM emp;` |
| `WHERE` | 条件过滤 | 我只想要符合特定条件的“文件”，比如“年龄大于30岁”的。 | `WHERE age > 30;` |
| `>` (大于) | 比较运算 | 筛选出某个数字项比指定值大的记录。 | `WHERE salary > 10000;` |
| `<` (小于) | 比较运算 | 筛选出某个数字项比指定值小的记录。 | `WHERE age < 30;` |
| `BETWEEN ... AND ...` | 范围查询 | 筛选出某个数字项在A和B之间（包括A和B）的记录。 | `WHERE age BETWEEN 20 AND 30;` |
| `IN (...)` | 集合查询 | 筛选出某个项的值刚好是我给出的几个特定值之一的记录。 | `WHERE age IN (22, 24, 28);` |

---

# 2 为什么需要数据库查询？Excel 不够用吗？

> [!QUOTE] 通俗概括
> 当你的数据多到像一个图书馆的书，而不是书桌上的几本书时，Excel 就像是你用眼睛一本本找，而 MySQL 查询就是图书馆里那个超高效的电脑检索系统。

我们最早接触数据，可能都是用 Excel 表格。它很直观，处理几百上千条数据也还行。但你想想，如果你的数据有几万、几十万、甚至上亿条呢？

-   **淘宝的商品记录**
-   **抖音每天产生的视频**
-   **一个大型网站的所有用户信息**

这种量级的数据，用 Excel 打开可能电脑直接就卡死了，更别提做什么筛选、计算了。它的性能、效率和功能都完全无法应对“海量数据”的场景。

这就是 **MySQL** 这种关系型数据库大显身手的地方。它就是为了高效管理和操作海量数据而生的。而它最核心、最能体现价值的功能，就是 **查询 (`SELECT`)**。我们 99% 的时间都是在从海量数据中，精准地捞出我们想要的那一小部分。

所以，请享受接下来学习的过程，你正在掌握一个能驾驭数据洪流的强大工具！

---

# 3 准备我们的“员工”数据

> [!NOTE] 通俗概括
> 在学习做菜前，我们得先准备好食材。这里，我们先创建一张“员工信息表”，并往里面放一些员工记录，这样后面才有东西可以查。

在查询之前，我们得先有数据。老师已经为我们准备好了一张员工表（`emp`）和一些数据。

### 3.1.1 创建员工表 (`emp`)

我们首先要用 `CREATE TABLE` 语句来定义这张表的“表头”，也就是它有哪些字段（列）。

```sql
CREATE TABLE emp (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(20) NOT NULL,
    gender ENUM('男', '女', '保密') NOT NULL DEFAULT '保密',
    age TINYINT UNSIGNED NOT NULL,
    department VARCHAR(20) NOT NULL,
    provence VARCHAR(20) NOT NULL,
    salary DOUBLE(7, 2) NOT NULL
);
```
**代码细节剖析：**
- `CREATE TABLE emp (...)`: 这句话的意思是“我要创建一张名为 `emp` 的表”。
- `id INT PRIMARY KEY AUTO_INCREMENT`:
    - `id INT`: `id` 字段是整数类型。
    - `PRIMARY KEY`: 它是“主键”，意味着每个员工的 `id` 都是独一无二的，像身份证号一样。
    - `AUTO_INCREMENT`: 每次新增员工时，`id` 会自动加 `$1$`，我们不用手动指定。
- `gender ENUM('男', '女', '保密')`:
    - 这是**枚举 (`ENUM`) 类型**，我们是第一次用！
    - 它的意思是 `gender` 字段的值**必须**是 `'男'`, `'女'`, `'保密'` 这三个选项中的一个。如果你想插入一个 `'未知'` 或者 `$1$`，MySQL 会直接报错。这保证了数据的规范性。
- `age TINYINT UNSIGNED`:
    - `TINYINT`: 这是“微小整数”，它只占用 `$1$` 个字节的存储空间。
    - `UNSIGNED`: 代表“无符号”，所以它的取值范围是 `$0$` 到 `$255$`。对于年龄来说，这个范围绰绰有余了，而且比用 `INT` 更节省空间。
- `salary DOUBLE(7, 2)`:
    - `DOUBLE`: 这是双精度浮点数类型，用来存小数，比如工资。
    - `(7, 2)`: 这里的 `$7$` 代表总共最多能存 `$7$` 位数字，`$2$` 代表其中小数点后要保留 `$2$` 位。所以，最大工资可以是 `$99999.99`。

### 3.1.2 批量插入数据

有了表结构，我们就要往里面填充记录了。一条一条 `INSERT` 太慢了，老师教了我们一个很帅的方法：**批量插入**。

```sql
INSERT INTO emp (name, gender, age, department, provence, salary) VALUES
('乔治', '男', 28, '技术部', '河北省', 6000.00),
('Dana', '女', 24, '市场部', '北京市', 12000.00),
('Sarah', '女', 32, '技术部', '上海市', 7500.00),
('Echo', '男', 22, '人事部', '广东省', 9000.00),
('David', '男', 45, '市场部', '北京市', 12500.88),
('Amy', '女', 38, '销售部', '江苏省', 12300.00);
-- (这里省略了其余的几十条记录，语法是一样的)
```

**代码细节剖析：**
- `INSERT INTO emp (...) VALUES ...`: 这个语法我们熟悉，就是往 `emp` 表的指定字段里插入值。
- `(...) VALUES (...), (...), (...)`: 关键就在这里！我们在 `VALUES` 后面跟了多个用括号括起来的记录，它们之间用逗号 `,` 隔开。这样，一条 `SQL` 语句就能一次性插入所有这些数据，执行效率极高，比你写几十条 `INSERT` 语句快得多！

---

# 4 基本查询：`SELECT ... FROM ...`

> [!QUOTE] 通俗概括
> 这是最基础的查询动作，告诉数据库：“喂，我要从某张表里拿数据了！”

查询的基本语法结构如下：
$$
\text{SELECT} \space \text{字段列表} \space \text{FROM} \space \text{表名};
$$
- `SELECT`: 关键字，意思是“选择/查询”。
- `字段列表`: 你想看哪些列的数据。
- `FROM`: 关键字，意思是“从...来”。
- `表名`: 你的数据来源是哪张表。

### 4.1.1 查询所有字段 (`*`)

如果你想看这张表里所有的信息，每一列都要，可以用星号 `*` (通配符)来代表“所有字段”。

```sql
SELECT * FROM emp;
```
执行后，你会得到 `emp` 表里全部 `$35$` 条记录，并且每一条记录的 `id`, `name`, `gender`, `age` 等所有字段都会显示出来。

### 4.1.2 查询指定字段

通常我们并不需要所有信息，可能我只关心员工的姓名（`name`）和薪水（`salary`）。这时，就可以明确指定你想要的字段名。

```sql
SELECT name, salary FROM emp;
```
执行后，结果就只会显示两列：`name` 和 `salary`。这更加清爽，也节省了网络传输的带宽。

> [!TIP] 开发最佳实践：为什么不推荐用 `*`？
> 老师强调了一个非常重要的细节：在实际开发和面试中，频繁使用 `SELECT *` 会被认为是**新手行为**。
>
> **原因：**
> 1.  **性能低下**：当你写 `*` 时，MySQL 数据库引擎需要先去“查字典”，看看这张表到底有哪些字段，然后再一个一个把它们找出来。而如果你直接告诉它 `SELECT name, salary`，它就省去了“查字典”的步骤，直奔主题，执行效率更高。
> 2.  **代码可读性和维护性差**：如果以后表结构变了（比如增加或删除了字段），`SELECT *` 返回的数据列数也会变，可能会导致依赖这些数据的程序出错。而明确写出字段名则不会有这个问题。
>
> 所以，即便你想查询所有字段，也应该把它们的名字都手动写出来，像这样：
> ```sql
> SELECT id, name, gender, age, department, provence, salary FROM emp;
> ```
> 虽然写起来麻烦一点，但这才是专业、高效的做法！

---

# 5 核心中的核心：用 `WHERE` 进行条件筛选

> [!QUOTE] 通俗概括
> 如果说 `SELECT` 是去图书馆借书，`WHERE` 就是你给图书管理员的具体指令：“我要找计算机类的、姓‘王’的作者写的、2020年以后出版的书”。它帮你从海量信息中精准定位。

单纯的 `SELECT ... FROM ...` 会把表里的所有记录都拿出来。但在真实场景中，我们几乎从不这样做。就像你逛淘宝，你不会去看所有商品，而是会筛选“手机”、“价格$1000$-$2000$”、“北京发货”等条件。

`WHERE` 子句就是用来实现这种**条件过滤**的。它的使用频率，比后面要学的 `GROUP BY`, `HAVING`, `ORDER BY`, `LIMIT` 加起来再乘以十还要多！

基本语法结构：
$$
\text{SELECT} \space \text{字段列表} \space \text{FROM} \space \text{表名} \space \text{WHERE} \space \text{条件表达式};
$$
`WHERE` 后面跟的就是你的筛选条件。

### 5.1.1 比较运算符 (`>`, `<`, $=$)

> [!NOTE] 通俗概括
> 就是用大于、小于、等于这些符号，对数字类型的字段进行筛选。

#### 5.1.1.1 案例1：查询年龄大于 $30$ 岁的所有员工

```sql
SELECT * FROM emp WHERE age > 30;
```
**代码剖析：**
- `WHERE age > 30`: 这就是我们的条件表达式。
- `age`: 我们要筛选的字段。
- `>`: 比较运算符，表示“大于”。
- `30`: 我们要比较的值。
- 整句话连起来就是：“从`emp`表中，把`age`字段的值大于`30`的那些行（记录）全部给我找出来。”
- 结果里，你将看不到任何年龄小于或等于 `$30$` 的员工。

#### 5.1.1.2 案例2：查询薪资大于 $10000$ 的员工

```sql
SELECT * FROM emp WHERE salary > 10000;
```
- 这个同理，就是筛选 `salary` 字段，找出那些月薪过万的“高薪人士”。

### 5.1.2 范围运算符 (`BETWEEN ... AND ...`)

> [!NOTE] 通俗概括
> 方便地筛选出某个数值在一个连续区间内的记录。

#### 5.1.2.1 案例：查询年龄在 $20$ 到 $30$ 岁之间的员工

```sql
SELECT * FROM emp WHERE age BETWEEN 20 AND 30;
```
**代码剖析：**
- `WHERE age BETWEEN 20 AND 30`: 筛选 `age` 字段。
- `BETWEEN A AND B`: 这是一个整体，表示“在A和B之间”。
- **重要细节**: 这个范围是**闭区间**，也就是说它**包含**边界值。`BETWEEN 20 AND 30` 等价于 `age >= 20 AND age <= 30`。所以年龄刚好是 `$20$` 岁和 `$30$` 岁的员工也会被查询出来。

### 5.1.3 集合运算符 (`IN`)

> [!NOTE] 通俗概括
> 筛选出某个字段的值，正好是你指定的那几个“离散值”中的一个。

#### 5.1.3.1 案例：查询年龄是 $22$ 岁、 $24$ 岁、或 $28$ 岁的员工

你可能会想，我用 `WHERE age = 22 OR age = 24 OR age = 28` 不就行了吗？可以，但如果条件有十几个呢？写起来就太长了。`IN` 语法就是为了简化这种场景。

```sql
SELECT * FROM emp WHERE age IN (22, 24, 28);
```
**代码剖析：**
- `WHERE age IN (22, 24, 28)`: 筛选 `age` 字段。
- `IN (...)`: 后面跟一个由逗号分隔的值列表。
- 整句话的意思是：“从`emp`表中，找出所有`age`字段的值**等于**`$22$` **或者** 等于`$24$` **或者** 等于`$28$`的员工记录。”

> [!WARNING] `BETWEEN` 和 `IN` 的区别
> - `BETWEEN` 是**连续的范围**。`BETWEEN 22 AND 28` 会包含 `$22, 23, 24, 25, 26, 27, 28`。
> - `IN` 是**离散的集合**。`IN (22, 28)` 只会包含 `$22$` 和 `$28$`，中间的 `$23`、`$24$` 等都不会被选中。
> 千万不要混淆它们！

---

好了同学，关于 `SELECT` 和 `WHERE` 的基础查询我们就先玩到这里。你已经掌握了数据库查询最重要、最根本的技能！我们下节课继续探索更多有趣的查询技巧！